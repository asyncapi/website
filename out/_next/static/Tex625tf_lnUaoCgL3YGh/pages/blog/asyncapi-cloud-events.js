(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"5bPu":function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return b}));var a,o=t("wx14"),r=t("Ff2n"),s=t("q1tI"),i=t.n(s),c=t("7ljp"),l=(i.a.createElement,a="CodeBlock",function(e){return console.warn("Component "+a+" was not imported, exported, or provided by MDXProvider as global scope"),Object(c.b)("div",e)}),p={},u="wrapper";function b(e){var n=e.components,t=Object(r.a)(e,["components"]);return Object(c.b)(u,Object(o.a)({},p,t,{components:n,mdxType:"MDXLayout"}),Object(c.b)("p",null,"I've been receiving the same question for a long time now: Should I use CloudEvents or AsyncAPI? \u2014 And my response has always been the same: it depends!"),Object(c.b)("p",null,"There is the belief by many people that AsyncAPI and CloudEvents are competing for the same thing. This can't be less true, and I'd like to explain you why. Read on!"),Object(c.b)("h1",{id:"what-is-cloudevents"},"What is CloudEvents?"),Object(c.b)("p",null,"From ",Object(c.b)("a",Object(o.a)({parentName:"p"},{href:"https://cloudevents.io"}),"cloudevents.io"),":"),Object(c.b)("blockquote",null,Object(c.b)("p",{parentName:"blockquote"},"Enter CloudEvents, a specification for ",Object(c.b)("strong",{parentName:"p"},"describing event data in a common way"),". CloudEvents seeks to ease event declaration and delivery across services, platforms and beyond!")),Object(c.b)("p",null,"The purpose of CloudEvents is to establish a common format for event data description. And it makes a lot of sense when you realize they are part of the ",Object(c.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/cncf/wg-serverless"}),"CNCF\u2019s Serverless Working Group"),"."),Object(c.b)("p",null,"If you are doing serverless or FaaS (Function as a Service), then CloudEvents is your best friend because the event is the only information you will have in your function during runtime. No topics or channels, no servers, no subscribers. Just the event and some extra information you may need to make your function work."),Object(c.b)("p",null,Object(c.b)("strong",{parentName:"p"},"CloudEvents is focused on the event")," and defines an envelope for your application's data. See an example from their repo:"),Object(c.b)("pre",null,Object(c.b)("code",Object(o.a)({parentName:"pre"},{className:"language-json"}),'{\n    "specversion" : "0.2",\n    "type" : "com.github.pull.create",\n    "source" : "https://github.com/cloudevents/spec/pull/123",\n    "id" : "A234-1234-1234",\n    "time" : "2018-04-05T17:31:00Z",\n    "comexampleextension1" : "value",\n    "comexampleextension2" : {\n        "othervalue": 5\n    },\n    "contenttype" : "text/xml",\n    "data" : "<much wow=\\"xml\\"/>"\n}\n')),Object(c.b)("p",null,"Here your event is actually ",Object(c.b)("inlineCode",{parentName:"p"},'<much wow=\\"xml\\"/>')," and the rest is meta information about your event. This envelope is what CloudEvents defines with the purpose of making event declaration reusable across services and platforms."),Object(c.b)("h1",{id:"what-is-asyncapi"},"What is AsyncAPI?"),Object(c.b)("p",null,"From the ",Object(c.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/asyncapi/asyncapi"}),"AsyncAPI repo"),":"),Object(c.b)("blockquote",null,Object(c.b)("p",{parentName:"blockquote"},"Create machine-readable definitions of your event-driven APIs.")),Object(c.b)("p",null,"The purpose of AsyncAPI is to provide a way for you to define how your event-driven applications (or APIs) communicate with the rest of the world. ",Object(c.b)("strong",{parentName:"p"},"AsyncAPI is focused on the application and the channels it uses to communicate"),". Similar to what ",Object(c.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/OAI/OpenAPI-Specification"}),"OpenAPI")," and ",Object(c.b)("a",Object(o.a)({parentName:"p"},{href:"https://raml.org/"}),"RAML")," do for REST APIs. Unlike CloudEvents \u2014who focuses on the message\u2014 AsyncAPI does not impose how your event must look like but, instead, allows you to strictly define its shape. See an example:"),Object(c.b)("pre",null,Object(c.b)("code",Object(o.a)({parentName:"pre"},{className:"language-yaml"}),"asyncapi: 2.0.0-rc1\nid: urn:com.asyncapi.examples.user\ninfo:\n  title: User service\n  version: 1.6.3\nchannels:\n  user/signedup:\n    publish:\n      message:\n        payload:\n          type: object\n          properties:\n            fullName:\n              type: string\n            email:\n              type: string\n              format: email\n")),Object(c.b)("p",null,"Looking at the example above, one can rapidly say this is the AsyncAPI definition of a User service, which its API version is 1.6.3 and it publishes to the ",Object(c.b)("inlineCode",{parentName:"p"},"user/signedup")," channel an event that is an object containing two properties: ",Object(c.b)("inlineCode",{parentName:"p"},"fullName")," and ",Object(c.b)("inlineCode",{parentName:"p"},"email"),"."),Object(c.b)("p",null,"We can define the event payload but its structure is totally free and user-defined. And that's what makes AsyncAPI so powerful! Since our event payload can be anything, it can also be a CloudEvents event."),Object(c.b)("h1",{id:"asyncapi--cloudevents"},"AsyncAPI + CloudEvents"),Object(c.b)("p",null,"Let's see an example of the two combined:"),Object(c.b)("pre",null,Object(c.b)("code",Object(o.a)({parentName:"pre"},{className:"language-yaml"}),"asyncapi: 2.0.0-rc1\nid: urn:com.asyncapi.examples.user\ninfo:\n  title: User service\n  version: 1.6.3\nchannels:\n  user/signedup:\n    publish:\n      message:\n        payload:\n          type: object\n          properties:\n            specversion:\n              type: string\n              enum: ['0.2']\n            type:\n              type: string\n              example: com.github.pull.create\n            source:\n              type: string\n              format: uri\n              example: urn:com.asyncapi.examples.user\n            id:\n              type: string\n              example: 'A234-1234-1234'\n            time:\n              type: string\n              format: date-time\n              example: 2018-04-05T17:31:00Z\n            contenttype:\n              type: string\n              example: 'application/json'\n            data:\n              type: object\n              properties:\n                fullName:\n                  type: string\n                email:\n                  type: string\n                  format: email\n")),Object(c.b)("p",null,"Looking at the example above, one can say this is the AsyncAPI definition of a User service, which its API version is 1.6.3 and it publishes to the ",Object(c.b)("inlineCode",{parentName:"p"},"user/signedup")," channel a CloudEvents event whose data is a JSON object containing two properties: ",Object(c.b)("inlineCode",{parentName:"p"},"fullName")," and ",Object(c.b)("inlineCode",{parentName:"p"},"email"),"."),Object(c.b)("h2",{id:"leveraging-asyncapi-custom-schema-formats"},"Leveraging AsyncAPI Custom Schema Formats"),Object(c.b)("p",null,"There's only one concern with the approach above: every single CloudEvents definition is going to be exactly the same from line 11 to 33 \u2014 except for the examples that were added in this blog for clarity."),Object(c.b)("p",null,"The default format for defining events (messages) in AsyncAPI 2.0 is JSON Schema. Thankfully, AsyncAPI provides a way to define events in your own custom format \u2014like Avro and Protobuf \u2014 or a hypothetical CloudEvents one in this case. See example:"),Object(c.b)(l,{highlightedLines:[10],mdxType:"CodeBlock"},"asyncapi: 2.0.0-rc1\nid: urn:com.asyncapi.examples.user\ninfo:\n  title: User service\n  version: 1.6.3\nchannels:\n  user/signedup:\n    publish:\n      message:\n        schemaFormat: 'application/cloudevents+json; version=0.2; charset=utf-8'\n        payload:\n          type: object\n          properties:\n            fullName:\n              type: string\n            email:\n              type: string\n              format: email"),Object(c.b)("p",null,"This results in a much shorter and nicer way of defining the usage of CloudEvents inside an AsyncAPI document."),Object(c.b)("h2",{id:"ok-its-possible-but-does-it-makes-sense"},"Ok, it's possible but, does it makes sense?"),Object(c.b)("p",null,"It really depends on your use case but it makes sense in scenarios where some kind of FaaS is involved. Consider the following example:"),Object(c.b)("p",null,Object(c.b)("img",Object(o.a)({parentName:"p"},{src:"/img/diagrams/asyncapi-cloudevents.webp",alt:null}))),Object(c.b)("p",null,"Reading the diagram from the bottom up, we see an overly simplified diagram of a sign up process. The ",Object(c.b)("inlineCode",{parentName:"p"},"user/signedup")," event flows from the REST API to the monitoring service and the FaaS API through the broker. The event could have the CloudEvents format so that both, the FaaS API and the monitoring service, understand it. Obviously, one may argue that the Faas API could be wrapping the event data in CloudEvents format and leave the rest of the events untouched, in plain JSON. Fair."),Object(c.b)("p",null,"So, does it really makes sense? It certainly does in some situations. Do you have to use AsyncAPI and CloudEvents together? As always that's up to you. ",Object(c.b)("strong",{parentName:"p"},"You have the tools. Choose them wisely.")),Object(c.b)("h1",{id:"conclusion"},"Conclusion"),Object(c.b)("p",null,"We've learned how AsyncAPI differs from CloudEvents. Before I finish these lines, I'd like to make something clear again: AsyncAPI focuses on the application and how it is connected; and CloudEvents focuses on the message. Both things are compatible and complementary. Evaluate what are your needs and decide which one suits them better. There's no one-size-fits-all solution."),Object(c.b)("p",null,"I hope you learned something new, if so, please consider donating to the ",Object(c.b)("a",Object(o.a)({parentName:"p"},{href:"https://opencollective.com/asyncapi"}),"AsyncAPI Initiative"),"."),Object(c.b)("p",null,Object(c.b)("undefined",{parentName:"p"},"Until next time! ",Object(c.b)("span",{role:"img","aria-label":"waving hand"},"\ud83d\udc4b"))))}b.isMDXComponent=!0},"7ljp":function(e,n,t){"use strict";t.d(n,"a",(function(){return u})),t.d(n,"b",(function(){return h}));var a=t("q1tI"),o=t.n(a);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=o.a.createContext({}),p=function(e){var n=o.a.useContext(l),t=n;return e&&(t="function"===typeof e?e(n):i(i({},n),e)),t},u=function(e){var n=p(e.components);return(o.a.createElement(l.Provider,{value:n},e.children))},b="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return(o.a.createElement(o.a.Fragment,{},n))}},m=o.a.forwardRef((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),u=p(t),b=a,m=u["".concat(s,".").concat(b)]||u[b]||d[b]||r;return t?o.a.createElement(m,i(i({ref:n},l),{},{components:t})):o.a.createElement(m,i({ref:n},l))}));function h(e,n){var t=arguments,a=n&&n.mdxType;if("string"===typeof e||a){var r=t.length,s=new Array(r);s[0]=m;var i={};for(var c in n)hasOwnProperty.call(n,c)&&(i[c]=n[c]);i.originalType=e,i[b]="string"===typeof e?e:a,s[1]=i;for(var l=2;l<r;l++)s[l]=t[l];return o.a.createElement.apply(null,s)}return o.a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},Ff2n:function(e,n,t){"use strict";function a(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}t.d(n,"a",(function(){return a}))},Qetd:function(e,n,t){"use strict";var a=Object.assign.bind(Object);e.exports=a,e.exports.default=e.exports},uaR7:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/asyncapi-cloud-events",function(){return t("5bPu")}])},wx14:function(e,n,t){"use strict";function a(){return(a=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}t.d(n,"a",(function(){return a}))}},[["uaR7",0,1]]]);